{"pageProps":{"post":{"attributes":{},"html":"<h1 id=\"finishing-the-cart\">Finishing the Cart</h1>\n<p>At <code>MenuPage</code> and <code>DetailsPage</code> add calls to <code>addToCart</code> function importing it first.</p>\n<p>Create a new file </p>\n<h2 id=\"componentscartitemjs\">components/CartItem.js</h2>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">import</span> { removeFromCart } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../services/Order.js&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CartItem</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">HTMLElement</span> {\n    <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-variable language_\">super</span>();    \n    }   \n\n    <span class=\"hljs-title function_\">connectedCallback</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">const</span> item = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">dataset</span>.<span class=\"hljs-property\">item</span>);\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">innerHTML</span> = <span class=\"hljs-string\">&quot;&quot;</span>; <span class=\"hljs-comment\">// Clear the element</span>\n\n        <span class=\"hljs-keyword\">const</span> template = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;cart-item-template&quot;</span>);\n        <span class=\"hljs-keyword\">const</span> content = template.<span class=\"hljs-property\">content</span>.<span class=\"hljs-title function_\">cloneNode</span>(<span class=\"hljs-literal\">true</span>);\n\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">appendChild</span>(content);    \n\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;.qty&quot;</span>).<span class=\"hljs-property\">textContent</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${item.quantity}</span>x`</span>;\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;.name&quot;</span>).<span class=\"hljs-property\">textContent</span> = item.<span class=\"hljs-property\">product</span>.<span class=\"hljs-property\">name</span>;\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;.price&quot;</span>).<span class=\"hljs-property\">textContent</span> = <span class=\"hljs-string\">`$<span class=\"hljs-subst\">${item.product.price.toFixed(<span class=\"hljs-number\">2</span>)}</span>`</span>;\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;a.delete-button&quot;</span>).<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, <span class=\"hljs-function\"><span class=\"hljs-params\">event</span> =&gt;</span> {\n            <span class=\"hljs-title function_\">removeFromCart</span>(item.<span class=\"hljs-property\">product</span>.<span class=\"hljs-property\">id</span>);\n        })\n      }\n}\n\ncustomElements.<span class=\"hljs-title function_\">define</span>(<span class=\"hljs-string\">&quot;cart-item&quot;</span>, <span class=\"hljs-title class_\">CartItem</span>);\n</code></pre>\n<h2 id=\"updating-the-page\">Updating the Page</h2>\n<p>Then, at <code>components/OrderPage.js</code> add the following code</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">OrderPage</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">HTMLElement</span> {\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"></span>) {\n      <span class=\"hljs-variable language_\">super</span>();\n  \n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span> = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">attachShadow</span>({ <span class=\"hljs-attr\">mode</span>: <span class=\"hljs-string\">&quot;open&quot;</span> });    \n      <span class=\"hljs-keyword\">const</span> styles = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;style&quot;</span>);\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span>.<span class=\"hljs-title function_\">appendChild</span>(styles);\n      <span class=\"hljs-keyword\">const</span> section = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;section&quot;</span>);\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span>.<span class=\"hljs-title function_\">appendChild</span>(section);\n\n      <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">loadCSS</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">const</span> request = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&quot;/components/OrderPage.css&quot;</span>);\n        styles.<span class=\"hljs-property\">textContent</span> = <span class=\"hljs-keyword\">await</span> request.<span class=\"hljs-title function_\">text</span>();\n      }\n      <span class=\"hljs-title function_\">loadCSS</span>();\n  }   \n\n  <span class=\"hljs-title function_\">connectedCallback</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;appcartchange&quot;</span>, <span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">render</span>();\n    })\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">render</span>();\n  }\n\n  <span class=\"hljs-title function_\">render</span>(<span class=\"hljs-params\"></span>) {\n    <span class=\"hljs-keyword\">let</span> section = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;section&quot;</span>);   \n    <span class=\"hljs-keyword\">if</span> (app.<span class=\"hljs-property\">store</span>.<span class=\"hljs-property\">cart</span>.<span class=\"hljs-property\">length</span>==<span class=\"hljs-number\">0</span>) {     \n      section.<span class=\"hljs-property\">innerHTML</span> = <span class=\"hljs-string\">`\n          &lt;p class=&quot;empty&quot;&gt;Your order is empty&lt;/p&gt;\n      `</span>;\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">let</span> html = <span class=\"hljs-string\">`\n          &lt;h2&gt;Your Order&lt;/h2&gt;\n          &lt;ul&gt;\n          &lt;/ul&gt;\n      `</span>;\n      section.<span class=\"hljs-property\">innerHTML</span> = html;\n\n      <span class=\"hljs-keyword\">const</span> template = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&quot;order-form-template&quot;</span>);\n      <span class=\"hljs-keyword\">const</span> content = template.<span class=\"hljs-property\">content</span>.<span class=\"hljs-title function_\">cloneNode</span>(<span class=\"hljs-literal\">true</span>);\n      section.<span class=\"hljs-title function_\">appendChild</span>(content);\n\n      <span class=\"hljs-keyword\">let</span> total = <span class=\"hljs-number\">0</span>;\n      <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> prodInCart <span class=\"hljs-keyword\">of</span> app.<span class=\"hljs-property\">store</span>.<span class=\"hljs-property\">cart</span>) {      \n          <span class=\"hljs-keyword\">const</span> item = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&quot;cart-item&quot;</span>);\n            item.<span class=\"hljs-property\">dataset</span>.<span class=\"hljs-property\">item</span> = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(prodInCart);\n          <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;ul&quot;</span>).<span class=\"hljs-title function_\">appendChild</span>(item);\n        \n          total += prodInCart.<span class=\"hljs-property\">quantity</span> * prodInCart.<span class=\"hljs-property\">product</span>.<span class=\"hljs-property\">price</span>;\n      }\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">root</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&quot;ul&quot;</span>).<span class=\"hljs-property\">innerHTML</span> += <span class=\"hljs-string\">`\n            &lt;li&gt;\n                &lt;p class=&#x27;total&#x27;&gt;Total&lt;/p&gt;\n                &lt;p class=&#x27;price-total&#x27;&gt;$<span class=\"hljs-subst\">${total.toFixed(<span class=\"hljs-number\">2</span>)}</span>&lt;/p&gt;\n            &lt;/li&gt;                \n        `</span>;            \n    }\n  }\n}\n</code></pre>\n","slug":"finishing-the-cart","title":"Finishing the Cart","section":"Reactive Programming","icon":"chain","filePath":"/Users/firt/Library/Mobile Documents/com~apple~CloudDocs/Trainings/FEM/YDNTL/vanilla/lessons/05-reactive-programming/G-finishing-the-cart.md","nextSlug":"/vanilla/lessons/reactive-programming/binding-form-data","prevSlug":"/vanilla/lessons/reactive-programming/listening-for-cart-updates"}},"__N_SSG":true}